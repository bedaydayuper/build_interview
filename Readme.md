# 1 随机数执行任务代码
## 操作手册：
1.1 启动Springboot 项目

1.2 执行  http://localhost:8080/submit  启动项目
执行完之后，会有一个 output.txt 文件输出在项目当前路径

1.3 执行 http://localhost:8080/cancel , 停止当前任务，并暂停已提交未执行的任务。

# 2 图片检索

2.1. 数据存储
图片存储：使用分布式文件系统（如AWS S3）来存储图片数据。
特征存储：提取每张图片的特征向量，存储这些向量，以便于快速检索。

2.2. 特征提取
使用深度学习模型提取图片的特征向量。这些向量抓取了图片的关键内容，适用于快速比较。
2.3. 相似性比较
应用近似最近邻搜索（ANN）算法，例如Facebook的Faiss，这些算法可以在巨大的数据集中高效地找到最近邻项。

2.4. 系统架构
前端服务：提供用户界面，允许用户上传图片。

后端服务：处理上传的图片，执行特征提取，并与特征数据库进行比较。

索引构建与维护：定期或实时更新图片库和特征索引，确保数据的更新性和准确性。

分布式处理：使用分布式计算框架（如Apache Spark）来并行处理数据和请求，提高系统处理能力和响应速度。

2.5. 性能优化
预处理和索引构建期间，可以采用批处理和流处理相结合的方式，以提高系统的整体效率和灵活性。

应用缓存机制，对常见的查询和热点数据进行缓存，提高处理的速度。

# 3 排查springboot 的http 超时问题
3.1. 日志和监控
审查日志：查看应用和服务器的日志，找出超时请求的共同点和可能的错误信息。
性能监控：使用工具（如Prometheus、Grafana）监控应用性能，识别瓶颈。

3.2. 代码和数据库优化
代码审查：检查相关接口的代码，寻找可能的性能问题，如不必要的循环、高复杂度算法等。
数据库查询优化：分析慢查询日志，优化数据库索引，调整查询逻辑。

3.3. 系统资源
资源瓶颈：检查CPU、内存和磁盘使用情况，确定是否因资源竞争或不足导致超时。
扩容考虑：如果资源经常达到瓶颈，考虑增加服务器资源或使用负载均衡分散请求。

3.4. 外部服务依赖，增加熔断机制
第三方服务：如果应用依赖外部API或服务，确保这些服务的响应时间和可靠性。

3.5. 并发处理
异步处理：对于耗时操作，考虑使用异步处理方式来避免阻塞主线程。

线程池管理：合理配置线程池大小和队列长度，防止线程被阻塞或系统过载。

3.6. 超时配置
修改超时时间：如果请求本身因复杂度或数据量较高，需要更多处理时间，考虑增加超时时间。
合理配置：在服务方和客户端，正确地配置各种超时，包括连接超时、读取超时等。 